<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Management System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
<style type="text/css" media="print">
.v-h {display:none;}
.form-container {padding: 0px;}</style>
</head>
<body>
    {% if session.get('user_id') %}
    <nav class="navbar v-h">
        <div class="nav-container">
            <div class="nav-brand">
                <h2>Order System</h2>
            </div>
            <button class="nav-toggle" onclick="toggleMobileMenu()" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-menu" id="navMenu">
                <a href="{{ url_for('order_list') }}" class="nav-link" onclick="closeMobileMenu()">Order List</a>
                <a href="{{ url_for('order_add') }}" class="nav-link" onclick="closeMobileMenu()">Add Order</a>
                <a href="{{ url_for('profile') }}" class="nav-link" onclick="closeMobileMenu()">Profile</a>
                {% if session.get('username') == 'admin' %}
                <a href="{{ url_for('admin_users') }}" class="nav-link" onclick="closeMobileMenu()">User Management</a>
                {% endif %}
                <div class="nav-user">
                    <span>{{ session.get('username', 'User') }}</span>
                    <a href="{{ url_for('logout') }}" class="btn-logout">Logout</a>
                </div>
            </div>
        </div>
    </nav>
    {% endif %}
    
    <div class="container">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div id="alertContainer">
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">
                            <button class="alert-close" onclick="closeAlert(this)">×</button>
                            <span class="alert-icon">
                                {% if category == 'success' %}✓
                                {% elif category == 'danger' %}✕
                                {% elif category == 'warning' %}⚠
                                {% elif category == 'info' %}ℹ
                                {% else %}✓
                                {% endif %}
                            </span>
                            <span class="alert-message">{{ message }}</span>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>

    <script>
    function toggleMobileMenu() {
        const navMenu = document.getElementById('navMenu');
        navMenu.classList.toggle('active');
    }

    function closeMobileMenu() {
        const navMenu = document.getElementById('navMenu');
        navMenu.classList.remove('active');
    }

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
        const navMenu = document.getElementById('navMenu');
        const navToggle = document.querySelector('.nav-toggle');

        if (navMenu && !navMenu.contains(event.target) && !navToggle.contains(event.target)) {
            navMenu.classList.remove('active');
        }
    });

    // Auto-hide flash messages after 1 seconds
    document.addEventListener('DOMContentLoaded', function() {
        const alertContainer = document.getElementById('alertContainer');
        if (alertContainer) {
            let autoHideTimer;
            let remainingTime = 1000;

            // Auto-hide function
            function hideAlerts() {
                const alerts = alertContainer.querySelectorAll('.alert');
                alerts.forEach(function(alert) {
                    alert.style.transform = 'scale(0.8)';
                    alert.style.opacity = '0';
                });
                setTimeout(function() {
                    alertContainer.style.opacity = '0';
                    setTimeout(function() {
                        alertContainer.remove();
                    }, 300);
                }, 200);
            }

            // Close single alert
            window.closeAlert = function(button) {
                const alert = button.closest('.alert');
                alert.style.transform = 'scale(0.8)';
                alert.style.opacity = '0';
                setTimeout(function() {
                    alert.remove();
                    // If no more alerts, remove container
                    const remainingAlerts = alertContainer.querySelectorAll('.alert');
                    if (remainingAlerts.length === 0) {
                        alertContainer.style.opacity = '0';
                        setTimeout(function() {
                            alertContainer.remove();
                        }, 300);
                    }
                }, 200);
            };

            // Start auto-hide timer
            autoHideTimer = setTimeout(hideAlerts, remainingTime);

            // Pause auto-hide when hovering
            const alerts = alertContainer.querySelectorAll('.alert');
            alerts.forEach(function(alert) {
                alert.addEventListener('mouseenter', function() {
                    clearTimeout(autoHideTimer);
                });

                alert.addEventListener('mouseleave', function() {
                    autoHideTimer = setTimeout(hideAlerts, remainingTime);
                });
            });

            // Close when clicking on backdrop
            alertContainer.addEventListener('click', function(e) {
                if (e.target === alertContainer) {
                    clearTimeout(autoHideTimer);
                    hideAlerts();
                }
            });
        }
    });
    </script>
</body>
</html>
